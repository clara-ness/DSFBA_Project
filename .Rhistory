cor(countries_cluster_3bis$gdp_per_person, countries_cluster_3bis$proportion_fat)
lm_gdp_pp_prop_fat_clust3 <- lm(countries_cluster_3bis$gdp_per_person ~ countries_cluster_3bis$proportion_fat)
kable(prettify(summary(lm_gdp_pp_prop_fat_clust3)))
#proportion animal protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_animal_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_animal_prot)
#proportion plant protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_plant_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_plant_prot)
#proportion carbs
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_carbs)
#proportion fat
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_fat)
#Diabetes - calories
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_animal)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_animal)
lm_diabm_cal_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_prot_animal)
lm_diabw_cal_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_prot_animal)
kable(prettify(summary(lm_diabm_cal_prot_animal)))
kable(prettify(summary(lm_diabw_cal_prot_animal)))
#Diabetes - proportion
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_animal_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_animal_prot)
lm_diabm_prop_animal_prot <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabw_prop_animal_prot <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot)))
kable(prettify(summary(lm_diabw_prop_animal_prot)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_animal_prot)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust1)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_animal_prot)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust2)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_animal_prot)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust3)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust3)))
#Diabetes - calories
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_plant)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_plant)
lm_diam_cal_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_prot_plant)
lm_diaw_cal_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_prot_plant)
kable(prettify(summary(lm_diam_cal_prot_plant)))
kable(prettify(summary(lm_diaw_cal_prot_plant)))
#Diabetes - proportion
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_plant_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_plant_prot)
lm_diabm_prop_plant_prot <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabw_prop_plant_prot <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot)))
kable(prettify(summary(lm_diabw_prop_plant_prot)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_plant_prot)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust1)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_plant_prot)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust2)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_plant_prot)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust3)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust3)))
#Diabetes - calories
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_carbs)
lm_diabm_cal_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_carbs)
lm_diabw_cal_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_carbs)
kable(prettify(summary(lm_diabm_cal_carbs)))
kable(prettify(summary(lm_diabm_cal_carbs)))
#Diabetes - proportion
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_carbs)
lm_diabm_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabw_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs)))
kable(prettify(summary(lm_diabw_prop_carbs)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_carbs)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_carbs)
lm_diabm_prop_carbs_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_carbs)
lm_diabw_prop_carbs_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust1)))
kable(prettify(summary(lm_diabw_prop_carbs_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_carbs)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_carbs)
lm_diabm_prop_carbs_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_carbs)
lm_diabw_prop_carbs_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust2)))
kable(prettify(summary(lm_diabw_prop_carbs_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_carbs)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_carbs)
lm_diabm_prop_carbs_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_carbs)
lm_diabw_prop_carbs_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust3)))
kable(prettify(summary(lm_diabw_prop_carbs_clust3)))
#Diabetes - calories
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_fat)
lm_diabm_cal_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_fat)
lm_diabw_cal_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_fat)
kable(prettify(summary(lm_diabm_cal_fat)))
kable(prettify(summary(lm_diabw_cal_fat)))
#Diabetes - proportion
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_fat)
lm_diabm_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabw_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat)))
kable(prettify(summary(lm_diabw_prop_fat)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_fat)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_fat)
lm_diabm_fat_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_fat)
lm_diabw_prop_fat_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_fat)
kable(prettify(summary(lm_diabm_fat_clust1)))
kable(prettify(summary(lm_diabw_prop_fat_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_fat)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_fat)
lm_diabm_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_fat)
lm_diabw_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust2)))
kable(prettify(summary(lm_diabw_prop_fat_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_fat)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_fat)
lm_diabm_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_fat)
lm_diabw_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust3)))
kable(prettify(summary(lm_diabw_prop_fat_clust3)))
#proportion animal protein
lm_diabetes_men_prop_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabetes_women_prop_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_animal)))
kable(prettify(summary(lm_diabetes_women_prop_prot_animal)))
#proportion plant protein
lm_diabetes_men_prop_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabetes_women_prop_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_plant)))
kable(prettify(summary(lm_diabetes_women_prop_prot_plant)))
#proportion carbs
lm_diabetes_men_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabetes_women_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabetes_men_prop_carbs)))
kable(prettify(summary(lm_diabetes_women_prop_carbs)))
#proportion fat
lm_diabetes_men_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabetes_women_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabetes_men_prop_fat)))
kable(prettify(summary(lm_diabetes_women_prop_fat)))
#means for each cluster
countries_cluster_1 <- countries_cluster_1[,-10]
cl1 <- summarize_all(countries_cluster_1, mean)
cl1 <- rbind(countries_cluster_1, cl1)
row.names(cl1)[12] <- ("Means")
kable(cl1[12,])
countries_cluster_2 <- countries_cluster_2[,-10]
cl2 <- summarize_all(countries_cluster_2, mean)
cl2 <- rbind(countries_cluster_2, cl2)
row.names(cl2)[17] <- ("Means")
kable(cl2[17,])
countries_cluster_3 <- countries_cluster_3[,-10]
cl3 <- summarize_all(countries_cluster_3, mean)
cl3 <- rbind(countries_cluster_3, cl3)
row.names(cl3)[3] <- ("Means")
kable(cl3[3,])
slices <- c(cl1[12,5],cl1[12,6],cl1[12,7], cl1[12,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 1")
slices <- c(cl2[17,5],cl2[17,6],cl2[17,7], cl2[17,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 2")
slices <- c(cl3[3,5],cl3[3,6],cl3[3,7], cl3[3,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 3")
#proportion animal protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_animal)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_animal)
#proportion plant protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_plant)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_plant)
#proportion carbs
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_carbs)
#proportion fat
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_fat)
#proportion animal protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_animal_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_animal_prot)
#proportion plant protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_plant_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_plant_prot)
#proportion carbs
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_carbs)
#proportion fat
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_fat)
View(GDP_diabetes_cal)
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = proportion_animal_prot, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = proportion_animal_prot, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = proportion_animal_prot, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = proportion_animal_prot, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes rate vs Proportion of animal protein consumed", x="Proportion", y="Diabetes rate") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#Diabetes - proportion
lm_diabm_prop_animal_prot <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabw_prop_animal_prot <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot)))
kable(prettify(summary(lm_diabw_prop_animal_prot)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_animal_prot)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust1)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_animal_prot)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust2)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_animal_prot)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_animal_prot)
lm_diabm_prop_animal_prot_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_animal_prot)
lm_diabw_prop_animal_prot_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_animal_prot)
kable(prettify(summary(lm_diabm_prop_animal_prot_clust3)))
kable(prettify(summary(lm_diabw_prop_animal_prot_clust3)))
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = proportion_plant_prot, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = proportion_plant_prot, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = proportion_plant_prot, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = proportion_plant_prot, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes rate vs Proportion of plant protein consumed", x="Proportion", y="Diabetes rate") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#Diabetes - proportion
lm_diabm_prop_plant_prot <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabw_prop_plant_prot <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot)))
kable(prettify(summary(lm_diabw_prop_plant_prot)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_plant_prot)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust1)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_plant_prot)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust2)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_plant_prot)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_plant_prot)
lm_diabm_prop_plant_prot_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_plant_prot)
lm_diabw_prop_plant_prot_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_plant_prot)
kable(prettify(summary(lm_diabm_prop_plant_prot_clust3)))
kable(prettify(summary(lm_diabw_prop_plant_prot_clust3)))
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = proportion_carbs, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = proportion_carbs, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = proportion_carbs, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = proportion_carbs, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes rate vs Proportion of carbs consumed", x="Proportion", y="Diabetes rate") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#Diabetes - proportion
lm_diabm_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabw_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs)))
kable(prettify(summary(lm_diabw_prop_carbs)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_carbs)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_carbs)
lm_diabm_prop_carbs_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_carbs)
lm_diabw_prop_carbs_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust1)))
kable(prettify(summary(lm_diabw_prop_carbs_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_carbs)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_carbs)
lm_diabm_prop_carbs_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_carbs)
lm_diabw_prop_carbs_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust2)))
kable(prettify(summary(lm_diabw_prop_carbs_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_carbs)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_carbs)
lm_diabm_prop_carbs_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_carbs)
lm_diabw_prop_carbs_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_carbs)
kable(prettify(summary(lm_diabm_prop_carbs_clust3)))
kable(prettify(summary(lm_diabw_prop_carbs_clust3)))
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = proportion_fat, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = proportion_fat, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = proportion_fat, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = proportion_fat, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes rate vs Proportion of fat consumed", x="Proportion", y="Diabetes rate") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#Diabetes - proportion
lm_diabm_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabw_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat)))
kable(prettify(summary(lm_diabw_prop_fat)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_fat)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_fat)
lm_diabm_fat_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_fat)
lm_diabw_prop_fat_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_fat)
kable(prettify(summary(lm_diabm_fat_clust1)))
kable(prettify(summary(lm_diabw_prop_fat_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_fat)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_fat)
lm_diabm_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_fat)
lm_diabw_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust2)))
kable(prettify(summary(lm_diabw_prop_fat_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_fat)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_fat)
lm_diabm_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_fat)
lm_diabw_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust3)))
kable(prettify(summary(lm_diabw_prop_fat_clust3)))
#proportion animal protein
lm_diabetes_men_prop_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabetes_women_prop_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_animal)))
kable(prettify(summary(lm_diabetes_women_prop_prot_animal)))
#proportion plant protein
lm_diabetes_men_prop_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabetes_women_prop_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_plant)))
kable(prettify(summary(lm_diabetes_women_prop_prot_plant)))
#proportion carbs
lm_diabetes_men_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabetes_women_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabetes_men_prop_carbs)))
kable(prettify(summary(lm_diabetes_women_prop_carbs)))
#proportion fat
lm_diabetes_men_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabetes_women_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabetes_men_prop_fat)))
kable(prettify(summary(lm_diabetes_women_prop_fat)))
#means for each cluster
countries_cluster_1 <- countries_cluster_1[,-10]
cl1 <- summarize_all(countries_cluster_1, mean)
cl1 <- rbind(countries_cluster_1, cl1)
row.names(cl1)[12] <- ("Means")
kable(cl1[12,])
countries_cluster_2 <- countries_cluster_2[,-10]
cl2 <- summarize_all(countries_cluster_2, mean)
cl2 <- rbind(countries_cluster_2, cl2)
row.names(cl2)[17] <- ("Means")
kable(cl2[17,])
countries_cluster_3 <- countries_cluster_3[,-10]
cl3 <- summarize_all(countries_cluster_3, mean)
cl3 <- rbind(countries_cluster_3, cl3)
row.names(cl3)[3] <- ("Means")
kable(cl3[3,])
slices <- c(cl1[12,5],cl1[12,6],cl1[12,7], cl1[12,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 1")
slices <- c(cl2[17,5],cl2[17,6],cl2[17,7], cl2[17,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 2")
slices <- c(cl3[3,5],cl3[3,6],cl3[3,7], cl3[3,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 3")
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = proportion_fat, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = proportion_fat, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = proportion_fat, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = proportion_fat, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes rate vs Proportion of fat consumed", x="Proportion", y="Diabetes rate") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#Diabetes - proportion
lm_diabm_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabw_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat)))
kable(prettify(summary(lm_diabw_prop_fat)))
#cluster 1
cor(countries_cluster_1bis$prop_men_diabetes, countries_cluster_1bis$proportion_fat)
cor(countries_cluster_1bis$prop_women_diabetes, countries_cluster_1bis$proportion_fat)
lm_diabm_fat_clust1 <- lm(countries_cluster_1bis$prop_men_diabetes ~ countries_cluster_1bis$proportion_fat)
lm_diabw_prop_fat_clust1 <- lm(countries_cluster_1bis$prop_women_diabetes ~ countries_cluster_1bis$proportion_fat)
kable(prettify(summary(lm_diabm_fat_clust1)))
kable(prettify(summary(lm_diabw_prop_fat_clust1)))
#cluster 2
cor(countries_cluster_2bis$prop_men_diabetes, countries_cluster_2bis$proportion_fat)
cor(countries_cluster_2bis$prop_women_diabetes, countries_cluster_2bis$proportion_fat)
lm_diabm_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_men_diabetes ~ countries_cluster_2bis$proportion_fat)
lm_diabw_prop_fat_clust2 <- lm(countries_cluster_2bis$prop_women_diabetes ~ countries_cluster_2bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust2)))
kable(prettify(summary(lm_diabw_prop_fat_clust2)))
#cluster 3
cor(countries_cluster_3bis$prop_men_diabetes, countries_cluster_3bis$proportion_fat)
cor(countries_cluster_3bis$prop_women_diabetes, countries_cluster_3bis$proportion_fat)
lm_diabm_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_men_diabetes ~ countries_cluster_3bis$proportion_fat)
lm_diabw_prop_fat_clust3 <- lm(countries_cluster_3bis$prop_women_diabetes ~ countries_cluster_3bis$proportion_fat)
kable(prettify(summary(lm_diabm_prop_fat_clust3)))
kable(prettify(summary(lm_diabw_prop_fat_clust3)))
#proportion animal protein
lm_diabetes_men_prop_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabetes_women_prop_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_animal)))
kable(prettify(summary(lm_diabetes_women_prop_prot_animal)))
#proportion plant protein
lm_diabetes_men_prop_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabetes_women_prop_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_plant)))
kable(prettify(summary(lm_diabetes_women_prop_prot_plant)))
#proportion carbs
lm_diabetes_men_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabetes_women_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabetes_men_prop_carbs)))
kable(prettify(summary(lm_diabetes_women_prop_carbs)))
#proportion fat
lm_diabetes_men_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabetes_women_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabetes_men_prop_fat)))
kable(prettify(summary(lm_diabetes_women_prop_fat)))
#means for each cluster
countries_cluster_1 <- countries_cluster_1[,-10]
cl1 <- summarize_all(countries_cluster_1, mean)
cl1 <- rbind(countries_cluster_1, cl1)
row.names(cl1)[12] <- ("Means")
kable(cl1[12,])
countries_cluster_2 <- countries_cluster_2[,-10]
cl2 <- summarize_all(countries_cluster_2, mean)
cl2 <- rbind(countries_cluster_2, cl2)
row.names(cl2)[17] <- ("Means")
kable(cl2[17,])
countries_cluster_3 <- countries_cluster_3[,-10]
cl3 <- summarize_all(countries_cluster_3, mean)
cl3 <- rbind(countries_cluster_3, cl3)
row.names(cl3)[3] <- ("Means")
kable(cl3[3,])
slices <- c(cl1[12,5],cl1[12,6],cl1[12,7], cl1[12,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 1")
slices <- c(cl2[17,5],cl2[17,6],cl2[17,7], cl2[17,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 2")
slices <- c(cl3[3,5],cl3[3,6],cl3[3,7], cl3[3,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Consumption Pattern : Cluster 3")
