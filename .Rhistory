# Taking subset of data table for the chosen entity i
tmp <- subset(daily_caloric,Entity == tmp, select = c("Year","Calories from animal protein (FAO (2017))","Calories from plant protein (FAO (2017))","Calories from fat (FAO (2017))","Calories from carbohydrates (FAO (2017))"))
# Melting the data by years (i.e. getting each value for the different rows for each year)
tmp <- melt(tmp ,  id.vars = 'Year', variable.name = 'Series')
# Print plot
print(ggplot(tmp, aes(Year,value)) + geom_line(aes(colour = Series),size = 2) + ylim(0,2000) +
labs(title = paste("Caloric consumption per year",cal_unique$Entity[i]),
y = "Calories", x = "Year"))
}
ggplot() +
geom_line(data = GDP_diabetes_cal, aes(x = avg_gdp, y = total_consumption), color = "orange") +
geom_line(data = GDP_diabetes_cal, aes(x = avg_gdp, y = cal_fat), color = "blue") +
geom_line(data = GDP_diabetes_cal, aes(x = avg_gdp, y = cal_carbs), color = "purple") +
geom_line(data = GDP_diabetes_cal, aes(x = avg_gdp, y = cal_prot_animal), color = "red") +
geom_line(data = GDP_diabetes_cal, aes(x = avg_gdp, y = cal_prot_plant), color = "green") +
labs(x = "Average GDP (in billion $)", y= "Calories")
ggplot(GDP_diabetes_cal, aes(x=GDP_diabetes_cal$avg_gdp, y=GDP_diabetes_cal$total_consumption)) +
geom_point() + # Show dots
geom_text(
label= (GDP_diabetes_cal$country_code),
nudge_x = 0.25, nudge_y = 0.25,
check_overlap = T)+
geom_smooth(mapping = aes(x = GDP_diabetes_cal$avg_gdp, y=GDP_diabetes_cal$total_consumption), color = "red", method = "lm")+
labs( x = "Average GDP (in billion $)", y = "Calories")
ggplot(GDP_diabetes_cal2, aes(x=GDP_diabetes_cal2$avg_gdp, y=GDP_diabetes_cal2$total_consumption)) +
geom_point() +
geom_text(
label= (GDP_diabetes_cal2$country_code),
nudge_x = 0.25, nudge_y = 0.25,
check_overlap = T)+
geom_smooth(mapping = aes(x = GDP_diabetes_cal2$avg_gdp, y=GDP_diabetes_cal2$total_consumption), color = "red", method = "lm")+
labs(x = "Average GDP (in billion $)", y = "Calories")
# Plotting the evolution of the prevalence of diabetes for each country
#Diabetes_EU2 <- Diabetes_EU[-c(2)] #remove ISO country code
#Diabetes_unique <- unique(Diabetes_EU2[c('country')]) # Sorting table by country (unique)
#for (i in 1:nrow(Diabetes_unique)) {
#tmp <- Diabetes_unique$country[i]
# Taking subset of data table for the chosen country i
#tmp2 <- subset(Diabetes_EU2,country == tmp, select = c("sex","year","prop_diabetes"))
# Print plot for each country
#print(ggplot(data = tmp2, mapping = aes(x = year, y =prop_diabetes, color =sex)) + geom_line()
#  + labs(title = paste("Evolution of diabetes prevalence in",tmp), x= "Year", y="Diabetes prevalence") + scale_y_continuous(labels = scales::percent))
#}
# Plotting the evolution of the prevalence of diabetes for each country
Diabetes_EU2 <- Diabetes_EU[-c(2)] #remove ISO country code
Diabetes_unique <- unique(Diabetes_EU2[c('country')]) # Sorting table by country (unique)
# Taking subset of data table for the chosen country
BelgiumPlot <- subset(Diabetes_EU2,country == 'Belgium', select = c("sex","year","prop_diabetes"))
# Print plot for each country
ggplot(data = BelgiumPlot, mapping = aes(x = year, y =prop_diabetes, color =sex)) + geom_line() + labs(title ="Evolution of diabetes prevalence in Belgium", x= "Year", y="Diabetes prevalence") + scale_y_continuous(labels = scales::percent)
# Taking subset of data table for the chosen country
AustriaPlot <- subset(Diabetes_EU2,country == 'Austria', select = c("sex","year","prop_diabetes"))
# Print plot for each country
ggplot(data = AustriaPlot, mapping = aes(x = year, y =prop_diabetes, color =sex)) + geom_line() + labs(title ="Evolution of diabetes prevalence in Austria", x= "Year", y="Diabetes prevalence") + scale_y_continuous(labels = scales::percent)
# Taking subset of data table for the chosen country
CroatiaPlot <- subset(Diabetes_EU2,country == 'Croatia', select = c("sex","year","prop_diabetes"))
# Print plot for each country
ggplot(data = CroatiaPlot, mapping = aes(x = year, y =prop_diabetes, color =sex)) + geom_line() + labs(title ="Evolution of diabetes prevalence in Croatia", x= "Year", y="Diabetes prevalence") + scale_y_continuous(labels = scales::percent)
# Diabetes vs total calories
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = total_consumption, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = total_consumption, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = total_consumption, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = total_consumption, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs total calories per day", x="Total calories per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from animal protein
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = cal_prot_animal, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_prot_animal, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_prot_animal, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_prot_animal, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from animal protein", x="Total calories from animal protein per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from plant protein
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = cal_prot_plant, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_prot_plant, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_prot_plant, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_prot_plant, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from plant protein", x="Total calories from plant protein per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from carbohydrates
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = cal_carbs, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_carbs, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_carbs, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_carbs, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from carbohydrates", x="Total calories from carbohydrates per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from fat
ggplot(data = GDP_diabetes_cal) +
geom_point(mapping = aes(x = cal_fat, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_fat, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_fat, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_fat, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from fat", x="Total calories from fat per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs total calories
ggplot(data = GDP_diabetes_cal2) +
geom_point(mapping = aes(x = total_consumption, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = total_consumption, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = total_consumption, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = total_consumption, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs total calories per day (without outliers)", x="Total calories per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from animal protein
ggplot(data = GDP_diabetes_cal2) +
geom_point(mapping = aes(x = cal_prot_animal, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_prot_animal, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_prot_animal, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_prot_animal, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from animal protein (without outliers)", x="Total calories from animal protein per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from plant protein
ggplot(data = GDP_diabetes_cal2) +
geom_point(mapping = aes(x = cal_prot_plant, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_prot_plant, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_prot_plant, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_prot_plant, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from plant protein (without outliers)", x="Total calories from plant protein per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from carbohydrates
ggplot(data = GDP_diabetes_cal2) +
geom_point(mapping = aes(x = cal_carbs, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_carbs, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_carbs, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_carbs, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from carbohydrates (without outliers)", x="Total calories from carbohydrates per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
# Diabetes vs calories from fat
ggplot(data = GDP_diabetes_cal2) +
geom_point(mapping = aes(x = cal_fat, y = prop_men_diabetes, color = "blue")) +
geom_smooth(mapping = aes(x = cal_fat, y = prop_men_diabetes, color = "blue"), formula = y ~ x, method = "lm") +
geom_point(mapping = aes(x = cal_fat, y = prop_women_diabetes, color = "red")) +
geom_smooth(mapping = aes(x = cal_fat, y = prop_women_diabetes, color = "red"), formula = y ~ x, method = "lm") +
labs(title="Diabetes vs daily calories from fat (without outliers)", x="Total calories from fat per day", y="Diabetes prevalence") +
scale_color_manual(labels = c("Men", "Women"), values = c("blue", "red")) +
scale_y_continuous(labels = scales::percent)
#with outliers
cor(GDP_diabetes_cal$avg_gdp, GDP_diabetes_cal$prop_women_diabetes)
cor(GDP_diabetes_cal$avg_gdp, GDP_diabetes_cal$prop_men_diabetes)
lm_gdp_diabetes_women <- lm(avg_gdp ~ prop_women_diabetes, data = GDP_diabetes_cal)
lm_gdp_diabetes_men <- lm(avg_gdp ~ prop_men_diabetes, data = GDP_diabetes_cal)
tab_model(
lm_gdp_diabetes_women, show.ci = FALSE, show.stat = TRUE, show.se = TRUE,
CSS = list(
css.width = '500px',
css.centeralign = 'text-align: left;',
css.firsttablecol = 'font-weight: bold;',
css.summary = 'color: black;'
)
)
tab_model(
lm_gdp_diabetes_men, show.ci = FALSE, show.stat = TRUE, show.se = TRUE,
CSS = list(
css.width = '500px',
css.centeralign = 'text-align: left;',
css.firsttablecol = 'font-weight: bold;',
css.summary = 'color: black;'
)
)
#without outliers
cor(GDP_diabetes_cal2$avg_gdp, GDP_diabetes_cal2$prop_women_diabetes)
cor(GDP_diabetes_cal2$avg_gdp, GDP_diabetes_cal2$prop_men_diabetes)
lm_gdp_diabetes_women2 <- lm(avg_gdp ~ prop_women_diabetes, data = GDP_diabetes_cal2)
lm_gdp_diabetes_men2 <- lm(avg_gdp ~ prop_men_diabetes, data = GDP_diabetes_cal2)
tab_model(
lm_gdp_diabetes_women2, show.ci = FALSE, show.stat = TRUE, show.se = TRUE,
CSS = list(
css.width = '500px',
css.centeralign = 'text-align: left;',
css.firsttablecol = 'font-weight: bold;',
css.summary = 'color: black;'
)
)
#without outliers
cor(GDP_diabetes_cal2$avg_gdp, GDP_diabetes_cal2$prop_women_diabetes)
cor(GDP_diabetes_cal2$avg_gdp, GDP_diabetes_cal2$prop_men_diabetes)
lm_gdp_diabetes_women2 <- lm(avg_gdp ~ prop_women_diabetes, data = GDP_diabetes_cal2)
lm_gdp_diabetes_men2 <- lm(avg_gdp ~ prop_men_diabetes, data = GDP_diabetes_cal2)
tab_model(
lm_gdp_diabetes_women2, show.ci = FALSE, show.stat = TRUE, show.se = TRUE,
CSS = list(
css.width = '500px',
css.centeralign = 'text-align: left;',
css.firsttablecol = 'font-weight: bold;',
css.summary = 'color: black;'
)
)
data_1 <- GDP_diabetes_cal[,-(1:2),drop=FALSE] #-> introduce the proportions later on ?
rownames(data_1) <- c("AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU","GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROU", "SVK", "SVN", "ESP", "SWE", "GBR", "CHE")
fviz_nbclust(data_1, kmeans, method = "wss") +
geom_vline(xintercept = 3, linetype = 2) + # add line for better visualisation
labs(subtitle = "Elbow method") # add subtitle
set.seed(123)
model_cluster <- kmeans(data_1, centers = 3, nstart = 10)
Data_cluster <- data.frame(data_1, cluster = as.factor(model_cluster$cluster))
countries_cluster_1 <- filter(Data_cluster, cluster == "1")
countries_cluster_2 <- filter(Data_cluster, cluster == "2")
countries_cluster_3 <- filter(Data_cluster, cluster == "3")
kbl(countries_cluster_1,
caption = "**Table**: Cluster 1",
align = c('cccccc')) %>%
kable_classic(full_width = T, html_font = "Cambria") %>%
kable_styling(bootstrap_options = c('striped', 'hover', 'condensed'))
kbl(countries_cluster_2,
caption = "**Table**: Cluster 2",
align = c('cccccc')) %>%
kable_classic(full_width = T, html_font = "Cambria") %>%
kable_styling(bootstrap_options = c('striped', 'hover', 'condensed'))
kbl(countries_cluster_3,
caption = "**Table**: Cluster 3",
align = c('cccccc')) %>%
kable_classic(full_width = T, html_font = "Cambria") %>%
kable_styling(bootstrap_options = c('striped', 'hover', 'condensed'))
res_kmeans <- cluster_analysis(data_1, n=3, method = "kmeans",iterations = 20)
predict(res_kmeans)
plot(res_kmeans)
#cluster 1
cor(countries_cluster_1$avg_gdp, countries_cluster_1$prop_women_diabetes)
cor(countries_cluster_1$avg_gdp, countries_cluster_1$prop_men_diabetes)
lm_gdp_diabetes_women_clust1 <- lm(countries_cluster_1$avg_gdp ~ countries_cluster_1$prop_women_diabetes)
lm_gdp_diabetes_men_clust1 <- lm(countries_cluster_1$avg_gdp ~ countries_cluster_1$prop_men_diabetes)
kable(prettify(summary(lm_gdp_diabetes_women_clust1)))
kable(prettify(summary(lm_gdp_diabetes_men_clust1)))
#cluster 2
cor(countries_cluster_2$avg_gdp, countries_cluster_2$prop_women_diabetes)
cor(countries_cluster_2$avg_gdp, countries_cluster_2$prop_men_diabetes)
lm_gdp_diabetes_women_clust2 <- lm(countries_cluster_2$avg_gdp ~ countries_cluster_2$prop_women_diabetes)
lm_gdp_diabetes_men_clust2 <- lm(countries_cluster_2$avg_gdp ~ countries_cluster_2$prop_men_diabetes)
kable(prettify(summary(lm_gdp_diabetes_women_clust2)))
kable(prettify(summary(lm_gdp_diabetes_men_clust2)))
#cluster 3
cor(countries_cluster_3$avg_gdp, countries_cluster_3$prop_women_diabetes)
cor(countries_cluster_3$avg_gdp, countries_cluster_3$prop_men_diabetes)
lm_gdp_diabetes_women_clust3 <- lm(countries_cluster_3$avg_gdp ~ countries_cluster_3$prop_women_diabetes)
lm_gdp_diabetes_men_clust3 <- lm(countries_cluster_3$avg_gdp ~ countries_cluster_3$prop_men_diabetes)
kable(prettify(summary(lm_gdp_diabetes_women_clust3)))
kable(prettify(summary(lm_gdp_diabetes_men_clust3)))
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$total_consumption)
lm_gdp_total_cal <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$total_consumption)
kable(prettify(summary(lm_gdp_total_cal)))
ggplot() +
geom_point(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = total_consumption), color = "orange") +
geom_smooth(mapping = aes(x = GDP_diabetes_cal$gdp_per_person, y=GDP_diabetes_cal$total_consumption), color = "orange", method = "lm") +
labs(x = "GDP per capita", y= "Calories")
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$total_consumption)
lm_gdp_pp_total_cal <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$total_consumption)
kable(prettify(summary(lm_gdp_pp_total_cal)))
#cluster 1
cor(countries_cluster_1$gdp_per_person, countries_cluster_1$total_consumption)
lm_gdp_total_cal_clust1 <- lm(countries_cluster_1$gdp_per_person ~ countries_cluster_1$total_consumption)
kable(prettify(summary(lm_gdp_total_cal_clust1)))
#cluster 2
cor(countries_cluster_2$gdp_per_person, countries_cluster_2$total_consumption)
lm_gdp_total_cal_clust2 <- lm(countries_cluster_2$gdp_per_person ~ countries_cluster_2$total_consumption)
kable(prettify(summary(lm_gdp_total_cal_clust2)))
#cluster 3
cor(countries_cluster_3$gdp_per_person, countries_cluster_3$total_consumption)
lm_gdp_total_cal_clust3 <- lm(countries_cluster_3$gdp_per_person ~ countries_cluster_3$total_consumption)
kable(prettify(summary(lm_gdp_total_cal_clust3)))
View(GDP_diabetes_cal)
View(GDP_diabetes_cal)
#adding proportions to the final table
GDP_diabetes_cal <- mutate(GDP_diabetes_cal, proportion_animal_prot = cal_prot_animal/total_consumption, proportion_plant_prot = cal_prot_plant/total_consumption, proportion_carbs = cal_carbs/total_consumption, proportion_fat = cal_fat/total_consumption)
View(GDP_diabetes_cal)
#with GDP per person + calories
ggplot() +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = total_consumption), color = "orange") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = cal_fat), color = "blue") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = cal_carbs), color = "purple") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = cal_prot_animal), color = "red") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = cal_prot_plant), color = "green") +
labs(x = "GDP per capita", y= "Calories")
#with GDP per person + proportions
ggplot() +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = proportion_fat), color = "blue") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = proportion_carbs), color = "purple") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = proportion_animal_prot), color = "red") +
geom_line(data = GDP_diabetes_cal, aes(x = gdp_per_person, y = proportion_plant_prot), color = "green") +
labs(x = "GDP per capita", y= "Proportion of calories")
#clustering pt 2
data_2 <- mutate(data_1, GDP_diabetes_cal[,12:15])
set.seed(123)
model_cluster_bis <- kmeans(data_2, centers = 3, nstart = 10)
Data_cluster_bis <- data.frame(data_2, cluster = as.factor(model_cluster_bis$cluster))
countries_cluster_1bis <- filter(Data_cluster_bis, cluster == "1")
countries_cluster_2bis <- filter(Data_cluster_bis, cluster == "2")
countries_cluster_3bis <- filter(Data_cluster_bis, cluster == "3")
res_kmeans_bis <- cluster_analysis(data_2, n=3, method = "kmeans",iterations = 20)
predict(res_kmeans_bis)
plot(res_kmeans_bis)
#Average GDP - calories
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$cal_prot_animal)
lm_gdp_cal_prot_animal <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$cal_prot_animal)
kable(prettify(summary(lm_gdp_cal_prot_animal)))
#GDP per capita - calories
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$cal_prot_animal)
lm_gdp_pp_cal_prot_animal <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$cal_prot_animal)
kable(prettify(summary(lm_gdp_pp_cal_prot_animal)))
#Average GDP - proportion
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$proportion_animal_prot)
lm_gdp_prop_animal_prot <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_gdp_prop_animal_prot)))
#GDP per capita - proportion
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$proportion_animal_prot)
lm_gdp_pp_prop_animal_prot <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_gdp_pp_prop_animal_prot)))
#cluster 1
cor(countries_cluster_1bis$gdp_per_person, countries_cluster_1bis$proportion_animal_prot)
lm_gdp_pp_prop_animal_prot_clust1 <- lm(countries_cluster_1bis$gdp_per_person ~ countries_cluster_1bis$proportion_animal_prot)
kable(prettify(summary(lm_gdp_pp_prop_animal_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$gdp_per_person, countries_cluster_2bis$proportion_animal_prot)
lm_gdp_pp_prop_animal_prot_clust2 <- lm(countries_cluster_2bis$gdp_per_person ~ countries_cluster_2bis$proportion_animal_prot)
kable(prettify(summary(lm_gdp_pp_prop_animal_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$gdp_per_person, countries_cluster_3bis$proportion_animal_prot)
lm_gdp_pp_prop_animal_prot_clust3 <- lm(countries_cluster_3bis$gdp_per_person ~ countries_cluster_3bis$proportion_animal_prot)
kable(prettify(summary(lm_gdp_pp_prop_animal_prot_clust3)))
#Average GDP - calories
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$cal_prot_plant)
lm_gdp_cal_prot_plant <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$cal_prot_plant)
kable(prettify(summary(lm_gdp_cal_prot_plant)))
#GDP per capita - calories
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$cal_prot_plant)
lm_gdp_pp_cal_prot_plant <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$cal_prot_plant)
kable(prettify(summary(lm_gdp_pp_cal_prot_plant)))
#Average GDP - proportion
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$proportion_plant_prot)
lm_gdp_prop_plant_prot <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_gdp_prop_plant_prot)))
#GDP per capita - proportion
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$proportion_plant_prot)
lm_gdp_pp_prop_plant_prot <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_gdp_pp_prop_plant_prot)))
#cluster 1
cor(countries_cluster_1bis$gdp_per_person, countries_cluster_1bis$proportion_plant_prot)
lm_gdp_pp_prop_plant_prot_clust1 <- lm(countries_cluster_1bis$gdp_per_person ~ countries_cluster_1bis$proportion_plant_prot)
kable(prettify(summary(lm_gdp_pp_prop_plant_prot_clust1)))
#cluster 2
cor(countries_cluster_2bis$gdp_per_person, countries_cluster_2bis$proportion_plant_prot)
lm_gdp_pp_prop_plant_prot_clust2 <- lm(countries_cluster_2bis$gdp_per_person ~ countries_cluster_2bis$proportion_plant_prot)
kable(prettify(summary(lm_gdp_pp_prop_plant_prot_clust2)))
#cluster 3
cor(countries_cluster_3bis$gdp_per_person, countries_cluster_3bis$proportion_plant_prot)
lm_gdp_pp_prop_plant_prot_clust3 <- lm(countries_cluster_3bis$gdp_per_person ~ countries_cluster_3bis$proportion_plant_prot)
kable(prettify(summary(lm_gdp_pp_prop_plant_prot_clust3)))
#Average GDP - calories
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$cal_carbs)
lm_gdp_cal_carbs <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$cal_carbs)
kable(prettify(summary(lm_gdp_cal_carbs)))
#GDP per capita - calories
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$cal_carbs)
lm_gdp_pp_cal_carbs <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$cal_carbs)
kable(prettify(summary(lm_gdp_pp_cal_carbs)))
#Average GDP - proportion
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$proportion_carbs)
lm_gdp_prop_carbs <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_gdp_prop_carbs)))
#GDP per capita - proportion
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$proportion_carbs)
lm_gdp_pp_prop_carbs <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_gdp_pp_prop_carbs)))
#cluster 1
cor(countries_cluster_1bis$gdp_per_person, countries_cluster_1bis$proportion_carbs)
lm_gdp_pp_prop_carbs_clust1 <- lm(countries_cluster_1bis$gdp_per_person ~ countries_cluster_1bis$proportion_carbs)
kable(prettify(summary(lm_gdp_pp_prop_carbs_clust1)))
#cluster 2
cor(countries_cluster_2bis$gdp_per_person, countries_cluster_2bis$proportion_carbs)
lm_gdp_pp_prop_carbs_clust2 <- lm(countries_cluster_2bis$gdp_per_person ~ countries_cluster_2bis$proportion_carbs)
kable(prettify(summary(lm_gdp_pp_prop_carbs_clust2)))
#cluster 3 - proportion carbs
cor(countries_cluster_3bis$gdp_per_person, countries_cluster_3bis$proportion_carbs)
lm_gdp_pp_prop_carbs_clust3 <- lm(countries_cluster_3bis$gdp_per_person ~ countries_cluster_3bis$proportion_carbs)
kable(prettify(summary(lm_gdp_pp_prop_carbs_clust3)))
#Average GDP - calories
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$cal_fat)
lm_gdp_cal_fat <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$cal_fat)
kable(prettify(summary(lm_gdp_cal_fat)))
#GDP per capita - calories
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$cal_fat)
lm_gdp_pp_cal_fat <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$cal_fat)
kable(prettify(summary(lm_gdp_pp_cal_fat)))
#Average GDP - proportion
cor(GDP_diabetes_cal$avg_gdp,GDP_diabetes_cal$proportion_fat)
lm_gdp_prop_fat <- lm(GDP_diabetes_cal$avg_gdp ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_gdp_prop_fat)))
#GDP per capita - proportion
cor(GDP_diabetes_cal$gdp_per_person,GDP_diabetes_cal$proportion_fat)
lm_gdp_pp_prop_fat <- lm(GDP_diabetes_cal$gdp_per_person ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_gdp_pp_prop_fat)))
#cluster 1
cor(countries_cluster_1bis$gdp_per_person, countries_cluster_1bis$proportion_fat)
lm_gdp_pp_prop_fat_clust1 <- lm(countries_cluster_1bis$gdp_per_person ~ countries_cluster_1bis$proportion_fat)
kable(prettify(summary(lm_gdp_pp_prop_fat_clust1)))
#cluster 2
cor(countries_cluster_2bis$gdp_per_person, countries_cluster_2bis$proportion_fat)
lm_gdp_pp_prop_fat_clust2 <- lm(countries_cluster_2bis$gdp_per_person ~ countries_cluster_2bis$proportion_fat)
kable(prettify(summary(lm_gdp_pp_prop_fat_clust2)))
#cluster 3
cor(countries_cluster_3bis$gdp_per_person, countries_cluster_3bis$proportion_fat)
lm_gdp_pp_prop_fat_clust3 <- lm(countries_cluster_3bis$gdp_per_person ~ countries_cluster_3bis$proportion_fat)
kable(prettify(summary(lm_gdp_pp_prop_fat_clust3)))
#calories animal protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_animal)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_animal)
#calories plant protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_prot_plant)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_prot_plant)
#calories carbs
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_carbs)
#calories fat
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$cal_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$cal_fat)
#calories animal protein
lm_diabetes_men_cal_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_prot_animal)
lm_diabetes_women_cal_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_prot_animal)
kable(prettify(summary(lm_diabetes_men_cal_prot_animal)))
kable(prettify(summary(lm_diabetes_women_cal_prot_animal)))
#calories plant protein
lm_diabetes_men_cal_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_prot_plant)
lm_diabetes_women_cal_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_prot_plant)
kable(prettify(summary(lm_diabetes_men_cal_prot_plant)))
kable(prettify(summary(lm_diabetes_women_cal_prot_plant)))
#calories carbs
lm_diabetes_men_cal_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_carbs)
lm_diabetes_women_cal_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_carbs)
kable(prettify(summary(lm_diabetes_men_cal_carbs)))
kable(prettify(summary(lm_diabetes_women_cal_carbs)))
#calories fat
lm_diabetes_men_cal_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$cal_fat)
lm_diabetes_women_cal_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$cal_fat)
kable(prettify(summary(lm_diabetes_men_cal_fat)))
kable(prettify(summary(lm_diabetes_women_cal_fat)))
#proportion animal protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_animal_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_animal_prot)
#proportion plant protein
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_plant_prot)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_plant_prot)
#proportion carbs
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_carbs)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_carbs)
#proportion fat
cor(GDP_diabetes_cal$prop_men_diabetes,GDP_diabetes_cal$proportion_fat)
cor(GDP_diabetes_cal$prop_women_diabetes,GDP_diabetes_cal$proportion_fat)
#proportion animal protein
lm_diabetes_men_prop_prot_animal <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
lm_diabetes_women_prop_prot_animal <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_animal_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_animal)))
kable(prettify(summary(lm_diabetes_women_prop_prot_animal)))
#proportion plant protein
lm_diabetes_men_prop_prot_plant <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
lm_diabetes_women_prop_prot_plant <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_plant_prot)
kable(prettify(summary(lm_diabetes_men_prop_prot_plant)))
kable(prettify(summary(lm_diabetes_women_prop_prot_plant)))
#proportion carbs
lm_diabetes_men_prop_carbs <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_carbs)
lm_diabetes_women_prop_carbs <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_carbs)
kable(prettify(summary(lm_diabetes_men_prop_carbs)))
kable(prettify(summary(lm_diabetes_women_prop_carbs)))
#proportion fat
lm_diabetes_men_prop_fat <- lm(GDP_diabetes_cal$prop_men_diabetes ~ GDP_diabetes_cal$proportion_fat)
lm_diabetes_women_prop_fat <- lm(GDP_diabetes_cal$prop_women_diabetes ~ GDP_diabetes_cal$proportion_fat)
kable(prettify(summary(lm_diabetes_men_prop_fat)))
kable(prettify(summary(lm_diabetes_women_prop_fat)))
#means for each cluster
countries_cluster_1 <- countries_cluster_1[,-10]
cl1 <- summarize_all(countries_cluster_1, mean)
cl1 <- rbind(countries_cluster_1, cl1)
row.names(cl1)[12] <- ("Means")
kable(cl1[12,])
countries_cluster_2 <- countries_cluster_2[,-10]
cl2 <- summarize_all(countries_cluster_2, mean)
cl2 <- rbind(countries_cluster_2, cl2)
row.names(cl2)[17] <- ("Means")
kable(cl2[17,])
countries_cluster_3 <- countries_cluster_3[,-10]
cl3 <- summarize_all(countries_cluster_3, mean)
cl3 <- rbind(countries_cluster_3, cl3)
row.names(cl3)[3] <- ("Means")
kable(cl3[3,])
slices <- c(cl1[12,5],cl1[12,6],cl1[12,7], cl1[12,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Pie Chart of Consumption Pattern of Cluster 1")
slices <- c(cl2[17,5],cl2[17,6],cl2[17,7], cl2[17,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Pie Chart of Consumption Pattern of Cluster 2")
slices <- c(cl3[3,5],cl3[3,6],cl3[3,7], cl3[3,8] )
lbls <- c("Animal Protein", "Plant Protein", "Carbs", "Fat")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices, labels = lbls,col=rainbow(length(lbls)), main="Pie Chart of Consumption Pattern of Cluster 3")
